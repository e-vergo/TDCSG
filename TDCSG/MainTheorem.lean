/-
Copyright (c) 2025 Eric Hearn. All rights reserved.
Released under Apache 2.0 license as described in the file LICENSE.
Authors: Eric Hearn
-/
import TDCSG.Definitions.Geometry
import TDCSG.Definitions.GroupAction
import Mathlib.Algebra.Group.Subgroup.Lattice

/-!
# Main Theorem: The Compound Symmetry Group GG₅ is Infinite

Theorem 2 from "Two-Disk Compound Symmetry Groups" (arXiv:2302.12950v1).

## Statement

The compound symmetry group GG(5,5) at the critical radius r_crit = √(3 + φ) is infinite.

## Mathematical Background

The compound symmetry group GG(n,n) is the subgroup of bijections of ℂ generated by:
- A_n: rotation by -2π/n about the left disk center (-1, 0)
- B_n: rotation by -2π/n about the right disk center (1, 0)

where each generator acts as the identity outside its respective disk.

For n = 5 at the critical radius, the group is infinite because it contains
points whose orbits are infinite (proven via interval exchange transformation analysis).

## Key Definitions

This file contains the essential definitions needed to understand the theorem statement.
The bijectivity proofs for the generators are in Definitions/GroupAction.lean.
-/

open Real Complex
open scoped Circle
open TDCSG.Definitions (leftDisk rightDisk leftCenter rightCenter rotateAboutC
  genA_n genB_n genA_n_bijective genB_n_bijective r_crit φ)

/-! ### Permutation Lifts

Using the bijectivity proofs, we can lift the generators to formal permutations.-/

/-- Generalized generator A_n as an element of `Equiv.Perm ℂ`.-/
noncomputable def genA_n_perm (n : ℕ) (hn : n ≥ 1) (r : ℝ) : Equiv.Perm ℂ :=
  Equiv.ofBijective (genA_n n r) (genA_n_bijective n hn r)

/-- Generalized generator B_n as an element of `Equiv.Perm ℂ`.-/
noncomputable def genB_n_perm (n : ℕ) (hn : n ≥ 1) (r : ℝ) : Equiv.Perm ℂ :=
  Equiv.ofBijective (genB_n n r) (genB_n_bijective n hn r)

/-! ### The Compound Symmetry Group GG(n,n)

The formal group structure: GG(n,n) is the subgroup of Equiv.Perm ℂ generated by
the two n-fold rotation generators.-/

/-- The compound symmetry group GG(n,n) at radius r.

This is the subgroup of `Equiv.Perm ℂ` generated by the two n-fold
rotation generators A_n and B_n. For each n ≥ 1 and radius r, we get
a different group.

The fundamental question: For which (n, r) is this group finite vs infinite?-/

noncomputable def TwoDiskCompoundSymmetryGroup (n : ℕ) (hn : n ≥ 1) (r : ℝ) :
    Subgroup (Equiv.Perm ℂ) :=
  Subgroup.closure {genA_n_perm n hn r, genB_n_perm n hn r}

/-- GG5: The compound symmetry group GG(5,5) at the critical radius.

    This is the main object of study in the paper. It is the 5-fold
    specialization: TwoDiskCompoundSymmetryGroup with n=5 and r=r_crit.-/
noncomputable def GG5_At_Critical_radius : Subgroup (Equiv.Perm ℂ) :=
  TwoDiskCompoundSymmetryGroup 5 (by norm_num) r_crit

/-! ### The Main Theorem -/

/-- **Theorem 2**: The compound symmetry group GG₅ at the critical radius is infinite.

    This is the precise statement from arXiv:2302.12950v1:
    The group generated by the two 5-fold rotation generators A and B,
    where each acts as the identity outside its disk, is an infinite group.

    Formally: `GG5_At_Critical_radius : Subgroup (Equiv.Perm ℂ)` has infinitely many elements.

    Proof strategy (in ProofOfMainTheorem.lean):
    1. Construct a specific point z whose orbit under GG5 is infinite
    2. Show this orbit analysis reduces to an interval exchange transformation
    3. Use ergodic theory to prove the IET has an infinite orbit
    4. Conclude that GG5 must be infinite (finite group ⟹ finite orbits) -/
def StatementOfTheorem : Prop :=
  Infinite GG5_At_Critical_radius
